<!DOCTYPE html>
<html>

<head>
    <title>Payment Infomation</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">
    <script type="text/javascript" src="https://js.stripe.com/v2/"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
    <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
    <script src="../../js/loggedIn.js"></script>
    <script src="../../js/main.js"></script>

    <link rel="stylesheet" type="text/css" href="../../css/main.css">
</head>
<body>
<div class="container">
    <div class="row">
        <h1>Payment Information</h1>

        <div class="leftNav">
            <a href="../main/index.html" class="btn-default btn">Home</a>
            <a href="purchasePowerUps.html" class="btn-default btn">Purchase Power Ups</a>
            <a href="currentPowerUps.html" class="btn-default btn">Current Power Ups</a>
            <a href="viewTransactions.html" class="btn-default btn">View Transactions</a>
            <!--<a href="paymentInfo.html" class="btn-default btn">Payment Information</a>-->
            <a href="../main/leaderboard.html" class="btn-default btn">Leaderboard</a>
            <a href="paymentStub.html" class="btn btn-default">Payment Stub</a>
            <a href="stats.html" class="btn btn-default">Stats</a>
            <a href="delete.html" class="btn-danger btn">Delete Account</a>
        </div>

        <div class="signedIn"></div>        <!-- Check if you are logged in -->

        <div class="scrollWrapper">
        <div class="card-wrapper">
            <div class="form-container active">
                <form action="javascipt:payment()" method="post">
                    <input placeholder="Card Number" type="text" name="number" size ="20"
                           maxlength="20" pattern="[\d ]+"â€¨ class="ccNumber"
                           oninvalid="setCustomValidity('The credit card must be 16 characters');"
                           oninput="setCustomValidity('')" autofocus autocomplete="off" required/>
                    <input placeholder="Full Name" type="text" name="name" pattern="[A-Z a-z]{1,20}"
                           oninvalid="setCustomValidity('Please enter your name');" class="ccName"
                           oninput="setCustomValidity('')" autocomplete="off" required>
                    <input placeholder="MM/YY" type="text" name="expiry" class="ccExp"
                           oninvalid="setCustomValidity('Please enter the month and year');"
                           oninput="setCustomValidity('')" autocomplete="off" required>
                    <input placeholder="CVC" type="text" name="cvc" class="ccCVC"
                           oninvalid="setCustomValidity('Please enter your CVC number');"
                           oninput="setCustomValidity('')" autocomplete="off" required><br>
                    <span class="buttonWrapper">
                    <input type="submit" class="ccSubmit" value="Add Card">
                    <input type="reset">
                    </span>
                </form>
                </div>
            </div>
        </div>
        </div>
    </div>
<script src="../../js/card.js"></script>
        <script>
            new Card({
                form: document.querySelector('form'),
                container: '.card-wrapper'
            });

            function payment() {
                var ccNumber = document.getElementsByClassName('ccNumber').value,
                        ccName = document.getElementsByClassName('ccName').value,
                        ccExp = document.getElementsByClassName('ccExp').value,
                        ccCVC = document.getElementsByClassName('ccCVC').value;

                // TODO: add AJAX call
                $.ajax({
                    url: 'http://52.32.43.132:8080/addCard?',
                    type: 'POST',
                    data: 'userID=' + local_userID + '&creditCardNumber=' + ccNumber + '&creditCardType=' + 'visa',
                    crossDomain: true,
                    success: function (response) {
                        alert(response);
                        sessionStorage.setItem('ccNumber', ccNumber);
                        sessionStorage.setItem('ccName', ccName);
                        sessionStorage.setItem('ccExp', ccExp);
                        sessionStorage.setItem('ccCVC', ccCVC);
//                var button = document.getElementsByClassName('jp-card-logo').value;
                        window.location.href = 'paymentStub.html';
                    }
                })
            }
        </script>
</body>
</html>